(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1119:function(e,t,o){"use strict";o(21),Object.defineProperty(t,"__esModule",{value:!0}),t.autoUpdateTimezone=function(e){return async(t,o)=>{const c=(0,r.getCurrentUser)(o()),d=(0,n.getUserTimezone)(o(),c.id),u=d.automaticTimezone!==e;if(d.useAutomaticTimezone&&u){const r={useAutomaticTimezone:"true",automaticTimezone:e,manualTimezone:d.manualTimezone},n=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(o,!0).forEach(function(t){i(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(o).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}({},c,{timezone:r});(0,s.updateMe)(n)(t,o)}}};var r=o(11),n=o(166),s=o(22);function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,r)}return o}function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}},1853:function(e,t,o){"use strict";o.r(t);o(95);var r=o(223),n=o(6),s=o(1119),a=o(13),i=o(15),c=o(11),d=o(1191),u=o(94),p=o.n(u),m=o(16),l=o.n(m),h=o(5),f=o.n(h),v=o(887),b=o(46),w=o(900),y=o(997),O=o(20),g=o(899),C=o(171),j=o(10),_=o(1149);function T(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const U=j.a.dispatch,z=j.a.getState,L=8;class E extends f.a.PureComponent{constructor(e){super(e),T(this,"onDesktopMessageListener",({origin:e,data:{type:t,message:{userIsActive:o,manual:r}={}}={}}={})=>{if(this.props.currentUser&&e===window.location.origin)switch(t){case"user-activity-update":!0!==o&&!1!==o||_.a.userUpdateActiveStatus(o,r)}});const t=document.getElementById("root");t&&(t.className+=" channel-view")}isValidState(){return null!=this.props.currentUser}componentDidMount(){y.b(),this.props.enableTimezone&&this.props.actions.autoUpdateTimezone(Object(C.a)()),p()(window).on("beforeunload",()=>{p()(window).off("beforeunload"),document.cookie.indexOf("MMUSERID=")>-1&&Object(b.viewChannel)("",this.props.currentChannelId||"")(U,z),y.a()}),window.addEventListener("focus",this.onFocusListener),window.addEventListener("blur",this.onBlurListener),window.addEventListener("message",this.onDesktopMessageListener),O.g()?p()("body").addClass("ios"):O.a()&&p()("body").addClass("android"),this.props.currentUser||(p()("#root").attr("class",""),w.e("/login?redirect_to="+encodeURIComponent(this.props.location.pathname),!0,!1)),p()("body").on("mouseenter mouseleave",":not(.post-list__dynamic) .post",function(e){"mouseenter"===e.type?(p()(this).prev(".date-separator, .new-separator").addClass("hovered--after"),p()(this).next(".date-separator, .new-separator").addClass("hovered--before")):(p()(this).prev(".date-separator, .new-separator").removeClass("hovered--after"),p()(this).next(".date-separator, .new-separator").removeClass("hovered--before"))}),p()("body").on("mouseenter mouseleave",".search-item__container .post",function(e){"mouseenter"===e.type?(p()(this).closest(".search-item__container").find(".date-separator").addClass("hovered--after"),p()(this).closest(".search-item__container").next("div").find(".date-separator").addClass("hovered--before")):(p()(this).closest(".search-item__container").find(".date-separator").removeClass("hovered--after"),p()(this).closest(".search-item__container").next("div").find(".date-separator").removeClass("hovered--before"))}),p()("body").on("mouseenter mouseleave",":not(.post-list__dynamic) .post.post--comment.same--root",function(e){"mouseenter"===e.type?(p()(this).prev(".date-separator, .new-separator").addClass("hovered--comment"),p()(this).next(".date-separator, .new-separator").addClass("hovered--comment")):(p()(this).prev(".date-separator, .new-separator").removeClass("hovered--comment"),p()(this).next(".date-separator, .new-separator").removeClass("hovered--comment"))}),p()(window).on("keydown.preventBackspace",e=>{e.which!==L||p()(e.target).is("input, textarea")||e.preventDefault()})}componentWillUnmount(){y.a(),p()("body").off("click.userpopover"),p()("body").off("mouseenter mouseleave",".post"),p()("body").off("mouseenter mouseleave",".post.post--comment.same--root"),p()(".modal").off("show.bs.modal"),p()(window).off("keydown.preventBackspace"),window.removeEventListener("focus",this.onFocusListener),window.removeEventListener("blur",this.onBlurListener),window.removeEventListener("message",this.onDesktopMessageListener)}render(){if(!this.isValidState())return f.a.createElement(g.a,null);if(this.props.mfaRequired){if("/mfa/setup"!==this.props.location.pathname)return f.a.createElement(v.a,{to:"/mfa/setup"})}else if("/mfa/confirm"===this.props.location.pathname);else if(this.props.showTermsOfService&&"/terms_of_service"!==this.props.location.pathname)return f.a.createElement(v.a,{to:"/terms_of_service?redirect_to="+encodeURIComponent(this.props.location.pathname)});return this.props.children}onFocusListener(){w.a(!0)}onBlurListener(){w.a(!1)}}T(E,"propTypes",{currentUser:l.a.object,currentChannelId:l.a.string,children:l.a.object,mfaRequired:l.a.bool.isRequired,enableTimezone:l.a.bool.isRequired,actions:l.a.shape({autoUpdateTimezone:l.a.func.isRequired}).isRequired,showTermsOfService:l.a.bool.isRequired});t.default=Object(r.connect)(function(e,t){const o=Object(i.getLicense)(e),r=Object(i.getConfig)(e),n=Object(c.shouldShowTermsOfService)(e);return{currentUser:Object(c.getCurrentUser)(e),currentChannelId:Object(a.getCurrentChannelId)(e),mfaRequired:Object(d.a)(Object(c.getCurrentUser)(e),o,r,t.match.url),enableTimezone:"true"===r.ExperimentalTimezone,showTermsOfService:n}},function(e){return{actions:Object(n.bindActionCreators)({autoUpdateTimezone:s.autoUpdateTimezone},e)}})(E)}}]);
//# sourceMappingURL=24.c3ef0d4850bb55b4b8d4.js.map